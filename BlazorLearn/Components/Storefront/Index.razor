@page "/store"
@using BlazorLearn.Data.DTOs
@inject ICatalogReadService Catalog
@rendermode InteractiveServer

<div class="sf-container mt-3">
    <!-- نوار بالای صفحه: مگامنو + جستجو -->
    <div class="d-flex align-items-center gap-3 mb-3">
        @* اگر خواستی بعداً فعال کن *@
        @* <MegaMenu /> *@

        <div class="flex-grow-1">
            <SearchBox CssClass="w-100" />
        </div>
    </div>

    <!-- اسلایدر -->
    <HeroSlider Slides="slides"
                CssClass="mb-3"
                Autoplay="true"
                IntervalMs="4500"
                ShowIndicators="true"
                ShowControls="true" />

    <!-- محصولات پیشنهادی -->
    <section class="mt-4">
        <div class="d-flex align-items-center mb-2">
            <h5 class="m-0">محصولات پیشنهادی</h5>
            <a class="ms-auto small text-secondary" href="/category/featured">مشاهده همه</a>
        </div>
        <div class="row g-3 row-cols-2 row-cols-md-3 row-cols-lg-4">
            @foreach (var p in products)
            {
                <div class="col">
                    <ProductCard Item="p" />
                </div>
            }
        </div>
    </section>
</div>

@code {
    private List<SlideDto> slides = new();
    private List<ProductDto> products = new();

    protected override async Task OnInitializedAsync()
    {
        slides = (await Catalog.GetSlidesAsync()).ToList();
        products = (await Catalog.GetFeaturedProductsAsync(12)).ToList();
    }
}
